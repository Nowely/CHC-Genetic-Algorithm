# ๐จโ ะฐะบัะธะฒะฝะพััะธ, ะบะพััะตะปะธัะพะฒะฐะฝะฝัะต ั ะฒะตะบัะพัะพะผ ะดะธะฝะฐะผะธัะตัะบะพะน ัะฐะทะผะตัะฝะพััะธ;
# ๐ฟ"โ" ัะฐัะฐะบัะตัะธััะธะบะธ ะฟะพัะตะฝัะธะฐะปะฐ ััะฐัะตะณะพัั, ะผะฝะพะถะตััะฒะพ ะฒะตัะตััะฒะตะฝะฝัั ัะธัะตะป;
# ๐"โ" ะบะพะผะฟะตัะตะฝัะฝะพัะฝะฐั ะผะพะดะตะปั ะดะธััะธะฟะปะธะฝั, ะผะฝะพะถะตััะฒะพ ะฒะตัะตััะฒะตะฝะฝัั ัะธัะตะป;
# ๐ฎ"โ" ะณะตะฝะพะผ, ะฟัะพัััะฐะฝััะฒะพ ะฟะพะธัะบะฐ ะดะปั ะฟะพัะตะฝัะธะฐะปัะฝัั ัะตัะตะฝะธะน;
# ๐ท^๐ "โ" ะฟะพะฟัะปััะธั t, ัะพััะพััะฐั ะธะท ะผะฝะพะถะตััะฒะพ ะฟะพัะตะฝัะธะฐะปัะฝัั ัะตัะตะฝะธะน, ะพัะพะฑะตะน;
# ๐พ(๐)"โ" ัะตะปะตะฒะฐั ััะฝะบัะธั;
# ๐(๐,๐)"โ" ัะฒัะธััะธะบะฐ, ััะฝะบัะธั ะปะธะฝะตะนะฝะพะน ัะตะณัะตััะธะธ;
# ๐^โ "โ" ะธัะบะพะผะพะต ัะตัะตะฝะธะต, ะพัะพะฑั ั ะพะฟัะตะดะตะปะตะฝะฝัะผ ะฝะฐะฑะพัะพะผ ะณะตะฝะพะฒ;
# ๐๐๐๐๐๐๐๐๐"โ" ะพะฟะตัะฐัะพั ัะตะปะตะบัะธะธ ะดะปั ะพัะฑะพัะฐ ะพัะพะฑะตะน ะฒ ัะปะตะดัััะตะต ะฟะพะบะพะปะตะฝะธะต;
# ๐๐๐๐๐๐๐๐"โ" ะพะฟะตัะฐัะพั ัะบัะตัะธะฒะฐะฝะธั ะดะปั ัะพะทะดะฐะฝะธั ะผะฝะพะถะตััะฒะฐ ะฝะพะฒัั ะพัะพะฑะตะน;
# ๐๐๐๐๐๐๐๐๐ ๐๐๐๐๐๐๐๐"โ" ะพะฟะตัะฐัะพั ะผััะฐัะธะธ, ะฟัะธ ะบะพัะพัะพะผ ะผะตะฝัะตััั ััะตัั ะณะตะฝะพะฒ.

# m - ะบะพะป-ะฒะพ ัะฐัะฐะบัะตัะธััะธะบ
# n - ะบะพะป-ะฒะพ ะดะพัััะฟะฝัั ะฐะบัะธะฒะฝะพััะตะน ะฒ ะฟัะปะต
import random

import numpy as np


class Individual:
    """ ะะปะฐัั ะพะดะฝะพะณะพ ะธะฝะดะธะฒะธะดะฐ ะฒ ะฟะพะฟัะปััะธะธ"""

    def __init__(self, m, n, fitness_function):
        # ะะพัะตะฝัะธะฐะปัะฝะพะต ัะตัะตะฝะธะต (ะณะตะฝะพะผ) - ะฟะตัะฒัะน ัะฐะท ะทะฐะดะฐะตััั ัะปััะฐะนะฝะพ
        self.genome = np.random.randint(0, 2, (m, n), dtype=bool)
        print(self.genome)
        # ะัะธัะฟะพัะพะฑะปะตะฝะฝะพััั ะธะฝะดะธะฒะธะดะฐ
        self.fitness = 0
        # ะะตัะตะดะฐัะฐ ััะฝะบัะธะธ ะฟัะธัะฟะพัะพะฑะปะตะฝะฝะพััะธ (ัะตะปะตะฒะฐั ััะฝะบัะธั)
        self.fitness_function = fitness_function
        # ะกัะธัะฐะตะผ ะฟัะธัะฟะพัะพะฑะปะตะฝะฝะพััั ะธะฝะดะธะฒะธะดะฐ
        self.calculate_fitness()

    def calculate_fitness(self):
        """ ะคัะฝะบัะธั ะดะปั ะฟะตัะตััะตัะฐ ะทะฝะฐัะตะฝะธั ะฟัะธัะฟะพัะพะฑะปะตะฝะฝะพััะธ ะธะฝะดะธะฒะธะดะฐ"""
        self.fitness = self.fitness_function(self.genome)

    def mutate_cataclysm(self):
        """ ะคัะฝะบัะธั ะดะปั ะผััะฐัะธะธ ะธะฝะดะธะฒะธะดะฐ, ะฟัะธ ะบะพัะพัะพะน ะผะตะฝัะตััั ะฟัะธะผะตัะฝะพ ััะตัั ะณะตะฝะพะฒ"""
        for i in range(self.genome.shape[0]):
            for j in range(self.genome.shape[1]):
                if random.random() <= 1 / 3:
                    self.genome[i, j] = not (self.genome[i, j])
        print(self.genome)


class Genetic:
    """ ะะปะฐัั, ะพัะฒะตัะฐััะธะน ะทะฐ ัะตะฐะปะธะทะฐัะธั ะณะตะฝะตัะธัะตัะบะพะณะพ ะฐะปะณะพัะธัะผะฐ"""

    def __init__(self,
                 individuals_number,
                 fitness_function,
                 top_rate,
                 m,
                 n,
                 delta
                 ):
        # ะะฐะทะผะตั ะฟะพะฟัะปััะธะธ
        self.individuals_number = individuals_number
        # ะฆะตะปะตะฒะฐั ััะฝะบัะธั
        self.fitness_function = fitness_function
        # ะะพะปั ะปัััะธั, ััะพ ะดะฐะดัั ะฟะพัะพะผััะฒะพ ะธ ะฟะตัะตะนะดัั ะฒ ัะปะตะดัััััั ะฟะพะฟัะปััะธั
        self.top_rate = top_rate
        # ะะฐะทะผะตัั ะผะฐััะธัั (ะณะตะฝะพะผะฐ)
        self.m = m
        self.n = n
        # ะะพัะพะณะพะฒะพะต ะทะฝะฐัะตะฝะธะต ะดะปั ัะฐััะพัะฝะธั
        self.delta = delta

        # ะัััะตะต ะทะฝะฐัะตะฝะธะต, ะบะพัะพัะพะต ะฑัะปะพ ะฒ ะฝะฐัะตะน ะฟะพะฟัะปััะธะธ
        self.best_fitness = None
        # ะะตะฝะพะผ ะปัััะตะณะพ ะทะฝะฐัะตะฝะธั
        self.best_genome = None

    def crossing(self, parent_1: Individual, parent_2: Individual):
        """ ะคัะฝะบัะธั ะดะปั ัะบัะตัะธะฒะฐะฝะธั ะดะฒัั ัะพะดะธัะตะปะตะน """
        if self.calculate_distance(parent_1, parent_2) > self.delta:
            # TODO ะฟะพะปะพะฒะธะฝะฐ ะฝะตัะพะฒะฟะฐะดะฐััะธั ะทะฝะฐัะตะฝะธะน ะพั ะบะฐะถะดะพะณะพ ัะพะดะธัะตะปั
            temp = 2

    def calculate_distance(self, parent_1: Individual, parent_2: Individual):
        """ ะคัะฝะบัะธั ะดะปั ะฒััะธัะปะตะฝะธั ัะฐัััะพัะฝะธั ะผะตะถะดั ัะพะดะธัะตะปัะผะธ"""
        result = 0
        # TODO ะฟะตัะตะดะฐะฒะฐัั ะธ ััะพั ะฟะฐัะฐะผะตัั? ะัะพะฒะตัะธัั ะตะณะพ ะฒะปะธัะฝะธะต
        d = 1

        for i in range(self.m):
            for j in range(self.n):
                if random.random() <= 1 / 3:
                    result += abs(parent_1.genome[i, j] - parent_2.genome[i, j]) ** d

        return result / parent_1.genome.size

    def start_genetic(self):
        """ ะะฐะฟััะบ ะพัะฑะพัะฐ"""
